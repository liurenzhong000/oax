webpackJsonp([22],{"L2J/":function(e,t,r){(e.exports=r("BkJT")(!1)).push([e.i,"\n.mini-dialog .el-dialog[data-v-d1b22fbe] {\n  width: 15%;\n  min-width: 400px;\n  height: 70%;\n}\n",""])},SQ6u:function(e,t,r){var a=r("L2J/");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r("8bSs")("2e364c1b",a,!0)},pobt:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("IHPB"),o=r.n(a),l=r("1onU"),i=r("vLgD");var s=r("6lZ+"),n={data:function(){return{listloading:!1,registerLoading:!1,dialogFormVisible:!1,userdialogForm:!1,roleIds:[],current_roleid:"",tableData:[],checked:!0,reqData:{pageNum:1,pageSize:10},pageInfo:{current_page:1,from:1,last_page:1,next_page_url:null,path:"",per_page:10,prev_page_url:null,to:1,total:1},multipleSelection:{},rolemultipleTable:[],selectArr:[],roleData:[],defaultProps:{children:"childrens",label:"name"},registerForm:{email:"",password:"",tel:"",name:"",username:""},registerRules:{roledesc:[{required:!0,message:this.generateAuthority("inrole"),trigger:"blur"}]}}},methods:{generateAuthority:r("ivlf").b,cancel:function(){this.userdialogForm=!1,this.registerForm={roledesc:""}},handleSelectionChange:function(e){this.multipleSelection=e},rolehandleSelectionChange:function(e){this.rolemultipleTable=e},handleList:function(){var e,t=this;this.listloading=!0,(e=this.reqData,Object(i.a)({url:"roles",method:"get",params:e})).then(function(e){t.listloading=!1;var r=e.data;t.tableData=r.list,t.pageInfo={current_page:Number(r.pageNum),from:1,last_page:r.lastPage,next_page_url:null,path:"",per_page:r.pageSize,prev_page_url:null,to:1,total:r.total}}).catch(function(e){console.log(e),t.listloading=!1})},openUser:function(e){e.enable?e.enable=0:e.enable=1},closeUser:function(e){e.enable?e.enable=0:e.enable=1},handleSizeChange:function(e){this.reqData.page_size=e,this.handleList()},handleCurrentChange:function(e){this.reqData.pageNum=e,this.handleList()},role:function(e){var t,r=this;this.dialogFormVisible=!0,this.current_roleid=e,(t=e,Object(i.a)({url:"resources/resourcesWithSelected/"+t,method:"get"})).then(function(e){r.roleData=e.data;var t=[];r.roleData.forEach(function(e,r){e.checked&&t.push(e.id),null!==e.childrens&&e.childrens.forEach(function(e,r){e.checked&&t.push(e.id),null!==e.childrens&&e.childrens.forEach(function(e,r){e.checked&&t.push(e.id)})})}),r.selectArr=[].concat(t),console.log(r.selectArr)}).catch(function(e){console.log(e)})},deleteRole:function(e){var t,r=this;(t=e,Object(i.a)({url:"roles/"+t,method:"delete"})).then(function(e){r.$message.success(e.msg),r.handleList()}).catch(function(e){console.log(e)})},addRole:function(){this.userdialogForm=!0,console.log("add")},save:function(){var e,t=this;if(console.log(this.$refs.tree.getCheckedKeys()),!this.$refs.tree.getCheckedKeys().length)return this.$message.error(this.generateAuthority("authorityselect")),!1;this.roleIds=[].concat(o()(this.$refs.tree.getCheckedKeys()),o()(this.$refs.tree.getHalfCheckedKeys())),this.roleIds&&(e={roleid:this.current_roleid,resourcesidArray:this.roleIds.join(",")},Object(i.a)({url:"roles/roleResources",method:"post",data:e})).then(function(e){t.$message.success(e.msg),t.dialogFormVisible=!1}).catch(function(e){console.log(e),t.dialogFormVisible=!1})},usersave:function(){var e=this;this.$refs.addroleForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;var r;e.registerLoading=!0,(r=e.registerForm,Object(i.a)({url:"roles",method:"post",data:r})).then(function(t){e.registerLoading=!1,e.$message.success(t.msg),e.userdialogForm=!1,e.registerForm={roledesc:""},e.handleList()}).catch(function(){e.registerLoading=!1})})}},mounted:function(){this.handleList()},components:{Pagination:l.a,QuitConfirm:s.a}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page"},[r("section",{staticClass:"list-table-container"},[r("section",{staticClass:"btn-container-area clearfix"},[r("el-button",{attrs:{type:"success"},on:{click:e.addRole}},[e._v(e._s(e.generateAuthority("add")))])],1),e._v(" "),r("section",{directives:[{name:"loading",rawName:"v-loading",value:e.listloading,expression:"listloading"}],staticClass:"table-container-area"},[r("el-table",{staticClass:"table",attrs:{data:e.tableData}},[r("el-table-column",{attrs:{width:"55"}}),e._v(" "),r("el-table-column",{attrs:{label:"ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{attrs:{title:t.row.id}},[r("span",[e._v(e._s(t.row.id))])])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:e.generateAuthority("role")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{attrs:{title:t.row.roledesc}},[r("span",[e._v(e._s(t.row.roledesc))])])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:e.generateAuthority("control")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary"},on:{click:function(r){e.role(t.row.id)}}},[e._v(e._s(e.generateAuthority("authority")))]),e._v(" "),r("quit-confirm",{attrs:{message:e.generateAuthority("delmsg"),type:"danger"},on:{handle:function(r){e.deleteRole(t.row.id)}}},[e._v(e._s(e.generateAuthority("del")))])]}}])})],1)],1),e._v(" "),r("section",{staticClass:"pagination-container"},[r("Pagination",{attrs:{pageInfo:e.pageInfo},on:{sizeChange:e.handleSizeChange,currentChange:e.handleCurrentChange}})],1)]),e._v(" "),r("el-dialog",{staticClass:"center-dialog mini-dialog",attrs:{title:e.generateAuthority("fprole"),visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-tree",{ref:"tree",attrs:{data:e.roleData,"show-checkbox":"","node-key":"id","default-expanded-keys":this.selectArr,"default-checked-keys":this.selectArr,props:e.defaultProps}}),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e.generateAuthority("save")))]),e._v(" "),r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.generateAuthority("cancel")))])],1)],1),e._v(" "),r("el-dialog",{staticClass:"center-dialog mini-dialog",attrs:{title:e.generateAuthority("addrole"),visible:e.userdialogForm},on:{"update:visible":function(t){e.userdialogForm=t}}},[r("section",{staticClass:"filter-container clearfix"},[r("el-form",{ref:"addroleForm",attrs:{model:e.registerForm,"label-width":"90px",rules:e.registerRules}},[r("el-form-item",{attrs:{prop:"roledesc",label:e.generateAuthority("role")+"ï¼š"}},[r("el-input",{attrs:{"auto-complete":"off",placeholder:e.generateAuthority("inrole"),clearable:""},model:{value:e.registerForm.roledesc,callback:function(t){e.$set(e.registerForm,"roledesc",t)},expression:"registerForm.roledesc"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",disabled:!e.checked,loading:e.registerLoading},nativeOn:{click:function(t){t.preventDefault(),e.usersave(t)}}},[e._v(e._s(e.generateAuthority("save")))]),e._v(" "),r("el-button",{on:{click:function(t){e.cancel()}}},[e._v(e._s(e.generateAuthority("cancel")))])],1)])],1)},staticRenderFns:[]};var d=r("/Xao")(n,c,!1,function(e){r("SQ6u")},"data-v-d1b22fbe",null);t.default=d.exports}});